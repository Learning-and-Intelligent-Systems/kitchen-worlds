<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="css/favicon.ico" />
    <title>Kitchen Worlds - Dev Notes</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Kitchen Worlds";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> Dev Notes
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Project</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href=".">Kitchen Worlds</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#lisdf-parser-testing">LISDF parser testing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#planning">Planning</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#scene-generation">Scene generation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#acknowledgements">Acknowledgements</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#todo">TODO</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="project-challenges/">Challenges of TAMP</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Planning Domains</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="domain-rearrangement/">Rearrangement Domain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="domain-predicates/">I) Predicates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="domain-operators/">II) Operators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="domain-axioms/">III) Axioms</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Planning Approach</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="planner-baselines/">Baseline Planners</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Experiments</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="exp-problems/">Planning Problems</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Set it up</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="setup-repository/">Set up the Repository</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="setup-mkdocs/">Set up MkDocs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="setup-notes/">Editor's Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="tut-lisdf/">LISDF</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="tut-lispddl/">LISPDDL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="tut-pddlstream/">PDDLStream</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">Dev Notes</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Project &raquo;</li><li>Kitchen Worlds</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="kitchen-worlds">Kitchen Worlds<a class="headerlink" href="#kitchen-worlds" title="Permanent link">#</a></h1>
<p>A library of long-horizon Task-and-Motion-Planning (TAMP) problems in kitchen and household scenes, as well as planners to solve them</p>
<ul>
<li>visualize a scene in LISDF format (an extension to SDF that includes URDF)</li>
<li>solve a TAMP problem using PDDLStream defined with a scene.lisdf, problem.pddl, domain.pddl, stream.pddl</li>
<li>procedurally generate scenes with rigid and articulated objects</li>
</ul>
<video autoplay loop muted playsinline width=100%>
  <source src="mp4/demo-cabbage.mp4" type="video/mp4">
</video>

<table class="multicol tightframes">
<tr>
<td width="33%">

<img src="imgs/demo-cabbage-1.png"></img>

</td>
<td width="33%">

<img src="imgs/demo-cabbage-2.png"></img>

</td>
<td width="33%">

<img src="imgs/demo-cabbage-4.png"></img>

</td>
</tr>
</table>

<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">#</a></h2>
<ol>
<li>Grab the submodules, may take a while</li>
</ol>
<pre><code class="language-shell">cd kitchen-worlds
git submodule update --init --recursive
</code></pre>
<ol>
<li>Build FastDownward, used by PDDLStream planner</li>
</ol>
<pre><code class="language-shell">cd pddlstream
./downward/build.py
</code></pre>
<ol>
<li>Checkout the right branch of lisdf paerse</li>
</ol>
<pre><code class="language-shell">cd ../lisdf
git checkout main
git checkout pddl-constant-support
</code></pre>
<ol>
<li>Install the other dependencies, in a virtual environment if you'd like. Have been tested on Python 3.7 and 3.8, on MacOS and on Ubuntu.</li>
</ol>
<pre><code class="language-shell">pip install virtualenv  ## if you haven't install
python3 -m virtualenv venv/kitchen
source venv/kitchen/bin/activate

pip install -r requirements.txt
pip install scipy untangle
</code></pre>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">#</a></h2>
<h3 id="lisdf-parser-testing">LISDF parser testing<a class="headerlink" href="#lisdf-parser-testing" title="Permanent link">#</a></h3>
<p>To run all tests before git push, do</p>
<pre><code class="language-commandline">cd tests
sh run_tests.sh
</code></pre>
<p>To test basic lisdf functions</p>
<pre><code class="language-commandline">## Test LISDF parser
python test_parse_lisdf.py

## Test load LISDF to Pybullet
python test_pybullet_lisdf.py

##  Test parse problem.pddl
python test_parse_pddl.py
</code></pre>
<h3 id="planning">Planning<a class="headerlink" href="#planning" title="Permanent link">#</a></h3>
<p>To solve some test problems wih PDDLStream, <code>-test</code> takes the name of subdirectory inside <code>test_cases</code> folder.</p>
<pre><code class="language-commandline">python test_pddlstream.py -test test_pr2_kitchen
</code></pre>
<p>Some test cases (verified that they can run on Ubuntu with Python 3.7/3.8):</p>
<table class="multicol">
<tr>
<td width="50%">

<img src="../gifs/220613-clean-only.gif"></img>

</td>
<td width="50%">

<img src="../gifs/220613-rearraneg-only.gif"></img>

</td>
</tr>
<tr>
<td width="50%">

`test_feg_clean_only`

</td>
<td width="50%">

`test_feg_cabinets_rearrange`

</td>
</tr>
</table>

<p>Note: There may be weird bounding boxes drawn during planning and pybullet throwing errors. if that happens and planning doesn't return a solution. Stop the script and run again. It may be a pybullet problem (happens only in Ubutun with python 3.8 but not MacOS with python 3.7)</p>
<p>Other test cases (to be uploaded soon):</p>
<table class="multicol">

<tr>
<td width="50%">

<img src="../gifs/220602-serve-plate.gif"></img>

</td>
<td width="50%">

<img src="../gifs/220531-cook-only.gif"></img>

</td>
</tr>
<tr>
<td width="50%">

`test_feg_dishwasher` (currently unavailable)

</td>
<td width="50%">

`test_feg_cook_only` (currently unavailable)

</td>
</tr>
</table>

<h3 id="scene-generation">Scene generation<a class="headerlink" href="#scene-generation" title="Permanent link">#</a></h3>
<p>To build some scenes.</p>
<pre><code class="language-commandline">python test_world_builder.py
</code></pre>
<p>The default script creates 10 scenes with variations on the following properties of movable objects: (1) mesh model instances, (2) poses on their assigned surface or space.</p>
<h2 id="acknowledgements">Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permanent link">#</a></h2>
<p>This repo works thanks for the tools provided by LIS lab members and alum:</p>
<ul>
<li>the <a href="https://github.com/caelan/pybullet-planning/tree/master/pybullet_tools">pybullet_tools</a> package is an awesome set of tools developed by Caelan Garret. A forked version is included with my own helper functions.</li>
<li>the <a href="https://github.com/caelan/pddlstream">pddlstream</a> is a planning framework developed by Caelan Garret.</li>
<li>the <a href="https://github.com/Learning-and-Intelligent-Systems/lisdf">lisdf</a> package is an input/output specification for TAMP problems developed by William Shen, Nishanth Kumar, Aidan Curtis, and Jiayuan Mao.</li>
</ul>
<p>All the object models and urdf files are downloaded for free from the following sources:</p>
<ul>
<li>most articulated object models are downloaded from <a href="https://sapien.ucsd.edu/browse">PartNet Mobility dataset</a> (Mo, Kaichun, et al. "Partnet: A large-scale benchmark for fine-grained and hierarchical part-level 3d object understanding." <em>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>. 2019.)</li>
<li>most kitchen object models are downloaded from <a href="https://free3d.com/3d-models/food">Free3D</a>.</li>
</ul>
<h2 id="todo">TODO<a class="headerlink" href="#todo" title="Permanent link">#</a></h2>
<ul>
<li>[x] add <code>requirements.txt</code></li>
<li>[x] upload test scene files in the format of <code>.lisdf</code> -&gt; need lisdf team to support a few more tags, including
  <code>xml
  &lt;include&gt;&lt;uri&gt;...&lt;/uri&gt;&lt;/include&gt;
  &lt;state&gt;...&lt;/state&gt;</code></li>
<li>[x] upload test scene files with <code>&lt;world&gt;&lt;gui&gt;&lt;camera&gt;&lt;pose&gt;</code></li>
<li>[x] update problem files in the format of <code>problem.pddl</code></li>
<li>[x] upload implicit domain files in the format of <code>domain.pddl</code></li>
<li>
<p>[x] add instructions to solve the example problems with TAMP planner <a href="https://github.com/caelan/pddlstream/tree/main">PDDLStream</a></p>
</li>
<li>
<p>[ ] run PDDLStream on one problem in each category, with the same domain, different scenes and goals</p>
</li>
<li>[ ] run PDDLStream with execution noise</li>
<li>[ ] run PDDLStream+HPN with execution noise</li>
<li>[ ] run TTM with execution noise</li>
<li>[ ] add instructions on sampling scenes</li>
<li>[ ] add instructions on sampling goals</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="project-challenges/" class="btn btn-neutral float-right" title="Challenges of TAMP">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="project-challenges/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
